<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Exam Generator - EEL</title>
  <link rel="icon" href="image/eel-character.png" type="image/png">
  <link rel="stylesheet" href="css/styles.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.css" rel="stylesheet">
    <script src="js/theme.js"></script>
</head>

<body class="exam-generator-page">
  <div class="mobile-nav-header" id="mobileNavHeader" role="banner">
    <button type="button" class="mobile-nav-btn mobile-nav-btn--menu" id="mobileNavMenuBtn" aria-label="Open menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true"><path d="M4 6h16M4 12h16M4 18h16"/></svg></button>
    <button type="button" id="eel-theme-header-toggle" class="theme-header-toggle" aria-label="Toggle dark/light mode"><span class="theme-icon" aria-hidden="true">‚òÄ</span><span class="theme-label">light</span></button>
  </div>
  <!-- Loading Screen -->
  <div id="loading-screen" class="loading-screen">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p>Loading Exam Generator...</p>
    </div>
  </div>

  <!-- Main Application Layout -->
  <div id="main-app" class="flex h-screen bg-background hidden">
    <!-- Sidebar -->
    <div id="sidebar" class="w-64 bg-sidebar border-r border-sidebar-border h-full flex flex-col">
      <div class="p-6">
        <h1 id="sidebar-title" class="text-xl font-semibold">EEL</h1>
        <p id="sidebar-welcome" class="text-sm text-muted-foreground mt-1">Welcome</p>
      </div>

      <!-- Back to Classes + Settings (with Logout below) -->
      <div class="p-4 space-y-2">
        <button id="back-class-btn"
          class="nav-button btn btn-side-bar w-full justify-start gap-3 p-3 rounded-md text-left transition-all flex items-center">
          <i data-lucide="arrow-left" class="size-5"></i>
          Back to Classes
        </button>
      </div>

      <nav id="sidebar-nav" class="flex-1 px-4 space-y-2"></nav>

      <div class="p-4">
        <button id="logout-btn" class="w-full p-3 logout-button btn-side-bar border">
          <i data-lucide="log-out"></i>
          Logout
        </button>
      </div>
    </div>

    <!-- Main Content -->
    <main id="main-content" class="flex-1 overflow-auto">
      <div class="p-6 space-y-6">
        <header class="page-header">
          <div class="page-header-icon" aria-hidden="true">
            <i data-lucide="sparkles" class="size-8"></i>
          </div>
          <div>
            <h1 class="page-header-title">AI Exam Generator</h1>
            <p class="page-header-subtitle">Create intelligent exams from any text or topic using AI.</p>
          </div>
        </header>

        <!-- Exam Generation Form -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <div class="card group cursor-pointer hover:shadow-lg transition-all duration-300 hover:-translate-y-1">
            <div class="card-header">
              <h3 class="card-title">Generate New Exam</h3>
              <p class="card-description">Provide a topic or text to generate exam questions automatically</p>
            </div>
            <div class="card-content space-y-6">
              <!-- Generation Method -->
              <div class="space-y-2">
                <label class="form-label">Generation Method</label>
                <div class="grid grid-cols-1 gap-4">
                  <label
                    class="flex items-center gap-2 p-3 border border-border rounded-lg cursor-pointer hover:bg-muted transition-colors" style="width: 100%; gap: 0.5rem; padding: 0.75rem 1rem; background: rgba(99, 102, 241, 0.05); color: #6366f1; border: 1px solid #6366f1; border-radius: 0.5rem;">
                    <input type="radio" name="method" value="topic" checked>
                    <div>
                      <div class="font-medium">From Topic</div>
                      <div class="text-xs text-muted-foreground">Generate questions about a specific topic</div>
                    </div>
                  </label>
                </div>
              </div>

              <!-- Topic Input -->
              <div id="topic-input" class="space-y-2">
                <label class="form-label">Select Topics</label>
                <div id="topicDropdownContainer" class="exam-topic-dropdown lessons-list space-y-2 border rounded p-2"></div>
              </div>

              <!-- Question Types with Count -->
              <div class="space-y-4">
                <label class="form-label">Question Types & Quantity</label>
                <div class="space-y-3">
                  <!-- Multiple Choice -->
                  <div class="exam-quantity-row" style="width: 100%; display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; padding: 0.75rem 1rem; background: rgba(99, 102, 241, 0.05); color: #6366f1; border: 1px solid #6366f1; border-radius: 0.5rem;">
                    <input type="checkbox" name="questionTypes" value="multiple-choice" class="form-checkbox"
                      id="questionType-multiple-choice">
                    <label for="questionType-multiple-choice" class="flex-1 cursor-pointer">
                      Multiple Choice
                    </label>
                    <div class="exam-quantity-wrap flex items-center gap-2">
                      <input type="number" min="0" class="form-input exam-quantity-input" placeholder="0"
                        id="count-multiple-choice" disabled>
                      <span class="text-sm text-muted-foreground">questions</span>
                    </div>
                  </div>

                  <!-- True/False -->
                  <div class="exam-quantity-row" style="width: 100%; display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; padding: 0.75rem 1rem; background: rgba(99, 102, 241, 0.05); color: #6366f1; border: 1px solid #6366f1; border-radius: 0.5rem;">
                    <input type="checkbox" name="questionTypes" value="true-false" class="form-checkbox"
                      id="questionType-true-false">
                    <label for="questionType-true-false" class="flex-1 cursor-pointer">
                      True/False
                    </label>
                    <div class="exam-quantity-wrap flex items-center gap-2">
                      <input type="number" min="0" class="form-input exam-quantity-input" placeholder="0"
                        id="count-true-false" disabled>
                      <span class="text-sm text-muted-foreground">questions</span>
                    </div>
                  </div>

                  <!-- Identification -->
                  <div class="exam-quantity-row" style="width: 100%; display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; padding: 0.75rem 1rem; background: rgba(99, 102, 241, 0.05); color: #6366f1; border: 1px solid #6366f1; border-radius: 0.5rem;">
                    <input type="checkbox" name="questionTypes" value="identification" class="form-checkbox"
                        id="questionType-identification">
                    <label for="questionType-identification" class="flex-1 cursor-pointer">
                      Identification
                    </label>
                    <div class="exam-quantity-wrap flex items-center gap-2">
                      <input type="number" min="0" class="form-input exam-quantity-input" placeholder="0"
                        id="count-identification" disabled>
                      <span class="text-sm text-muted-foreground">questions</span>
                    </div>
                  </div>

                  <!-- Essay -->
                  <div class="exam-quantity-row" style="width: 100%; display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; padding: 0.75rem 1rem; background: rgba(99, 102, 241, 0.05); color: #6366f1; border: 1px solid #6366f1; border-radius: 0.5rem;">
                    <input type="checkbox" name="questionTypes" value="essay" class="form-checkbox"
                      id="questionType-essay">
                    <label for="questionType-essay" class="flex-1 cursor-pointer">
                      Essay
                    </label>
                    <div class="exam-quantity-wrap flex items-center gap-2">
                      <input type="number" min="0" class="form-input exam-quantity-input" placeholder="0"
                        id="count-essay" disabled>
                      <span class="text-sm text-muted-foreground">questions</span>
                    </div>
                  </div>
                </div>
              </div>

              <button id="generateExamBtn" class="btn btn-primary">
                <i data-lucide="brain" class="size-4 mr-2"></i>
                Generate Exam with AI
              </button>
            </div>
          </div>
        </div>

        <!-- ‚úÖ Generated Exam Result (Hidden by Default) -->
        <div id="generatedExamContainer" class="hidden mt-6 p-6 border border-border rounded-lg bg-card shadow relative text-card-foreground">
          <h3 class="text-lg font-semibold text-primary mb-4">Generated Exam Result</h3>
          
          <div id="generatedExamContent" class="whitespace-pre-wrap text-sm text-foreground"></div>

          <!-- ‚úÖ Buttons at bottom-right (theme-aware) -->
          <div class="absolute bottom-4 right-4 flex gap-2">
            <button id="editExamBtn" class="btn btn-outline exam-edit-btn">
              ‚úèÔ∏è Edit
            </button>
            <button id="saveExamBtn" class="btn btn-primary exam-save-btn">
              üíæ Save
            </button>
          </div>
        </div>

        <!-- Exam List ‚Äì violet & green theme -->
        <div class="card exam-list-section">
          <div class="exam-list-section-header">
            <h3 class="exam-list-section-title"><i data-lucide="file-text" class="exam-list-icon"></i> Exam List</h3>
            <p class="exam-list-section-sub">Your saved exams ‚Äî export or move to cache</p>
          </div>
          <div class="exam-list-section-content">
            <div class="exam-list-grid" id="exam-list">
              <!-- Exam cards injected by JS -->
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="js/auth.js"></script>
    <script src="js/navigation.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.2/package/dist/xlsx.full.min.js"></script>
    <script src="js-front-end/api-config.js"></script>
    <script src="js-front-end/front-exam.js"></script>

    <script>
      document.querySelectorAll('input[name="questionTypes"]').forEach(checkbox => {
        checkbox.addEventListener('change', () => {
          const countInput = document.getElementById(`count-${checkbox.value.toLowerCase().replace(/ /g,'-')}`);
          if (checkbox.checked) {
            countInput.value = 1;      // automatically set to 1
            countInput.disabled = false; // enable input
          } else {
            countInput.value = 0;       // reset to 0
            countInput.disabled = true; // disable input
          }
        });
      });
    </script>
</body>
</html>
